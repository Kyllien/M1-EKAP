baseEco <- cbind(base[,-c(3,4,5,7,14,31,32)],mediadata,AxePP,Parent1PP,Parent2PP)
BaseModele<-mlogit.data(baseEco,shape="wide",varying=c(34:51,53:70,72:89),choice="PP")
#Pb apercu suite a la mise en place de la base car un des individus ne correspond pas a TRUE sur PP donc on va le chercher et le supprimer
dataCorrec <- subset(BaseModele, BaseModele$PP==TRUE)
#Remise en place de la base
baseEco2 <- baseEco[-133,]
BaseModele<-mlogit.data(baseEco2,shape="wide",varying=c(34:51,53:70,72:89),choice="PP")
ml.PP <- mlogit(PP~AxePP + Parent1PP + Parent2PP| Revenu + Media_Princ , data=BaseModele)
ml.PP <- mlogit(PP~AxePP + Parent1PP + Parent2PP| Revenu + Ouverture , data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~AxePP + Parent1PP + Parent2PP| Revenu + Proprietaire , data=BaseModele)
ml.PP <- mlogit(PP~AxePP + Parent1PP + Parent2PP| Proprietaire , data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~AxePP + Parent1PP + Parent2PP| Proprietaire + Revenu, data=BaseModele)
ml.PP <- mlogit(PP~AxePP + Parent1PP + Parent2PP|JournalTv, data=BaseModele)
ml.PP <- mlogit(PP~AxePP + Parent1PP + Parent2PP| Proprietaire , data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~AxePP + Parent1PP + Parent2PP| Revenu, data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~AxePP + Parent1PP + Parent2PP| Revenu + Proprietaire, data=BaseModele)
summary(ml.PP)
#multinomial simple
library(VGAM)
Fit1<-vglm(PP~Age + Revenu,multinomial(refLevel=1),data=baseEco2)
summary(Fit1)
ml.PP <- mlogit(PP~AxePP + Parent1PP + Parent2PP| Nbre_Hab, data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~AxePP + Parent1PP + Parent2PP| Propietaire + Categorie_Parent1, data=BaseModele)
ml.PP <- mlogit(PP~AxePP + Parent1PP + Parent2PP| Proprietaire + Categorie_Parent1, data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~0| Proprietaire + Categorie_Parent1, data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~0| Parent2_Categorie + Categorie_Parent1, data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~0| Parent2_Categorie, data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~0| Categorie_Parent1, data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~0|Nbre_Hab + Categorie_Parent1, data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~0|Proprietaire + Categorie_Parent1, data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~0|Proprietaire , data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~0|Etude_Parent1 + Categorie_Parent1, data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~0|Ouverture + Categorie_Parent1, data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~AxePP| Categorie_Parent1, data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~AxePP+Parent1PP| Categorie_Parent1, data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~AxePP+Parent2PP| Categorie_Parent1, data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~AxePP| Categorie_Parent1 + Satisfaction, data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~AxePP| Categorie_Parent1 + Age, data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~AxePP+Parent2PP| Age, data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~AxePP| Categorie_Parent1 + Proprietaire, data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~AxePP| Categorie_Parent1 , data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~0|Categorie_Parent1, data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~0|Categorie_Parent1, data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~AxePP| Categorie_Parent1 , data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~AxePP+Parent2PP| Age, data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~AxePP+Parent2PP| Categorie_Parent1, data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~AxePP+Parent1PP| Categorie_Parent1, data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~AxePP+Parent1PP+Parent2PP| Categorie_Parent1, data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~AxePP+Parent1PP+Parent2PP| Categorie_Parent1 + Parent2_Categorie + Etude_Parent1 + Etude_Parent2, data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~AxePP+Parent1PP| Categorie_Parent2, data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~AxePP+Parent1PP| Parent_Categorie2, data=BaseModele)
ml.PP <- mlogit(PP~AxePP+Parent1PP| Parent2_Categorie, data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~0|Parent2_Categorie, data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~AxePP+Parent1PP+Parent2PP| JournalPap + Categorie_Parent1 + Parent2_Categorie + Etude_Parent1 + Etude_Parent2, data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~AxePP| Categorie_Parent1 + Etude_Parent1, data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~AxePP|  Etude_Parent1, data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~AxePP+Parent1PP+Parent2PP| JournalPap + Categorie_Parent1 + Parent2_Categorie, data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~0|Ouverture + Anxiete + Satisfaction + Impulsivite + Extraversion + Agreabilite, data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~0| JournalTv + Ouverture + Anxiete + Satisfaction + Impulsivite + Extraversion + Agreabilite, data=BaseModele)
ml.PP <- mlogit(PP~0| Internet + Ouverture + Anxiete + Satisfaction + Impulsivite + Extraversion + Agreabilite, data=BaseModele)
ml.PP <- mlogit(PP~0| ChaineInfo + Ouverture + Anxiete + Satisfaction + Impulsivite + Extraversion + Agreabilite, data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~0| ChaineInfo, data=BaseModele)
summary(ml.PP)
<
ml.PP <- mlogit(PP~0|Categorie_Parent1, data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~AxePP| Categorie_Parent1 , data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~AxePP+Parent1PP| Categorie_Parent1 , data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~AxePP+Parent1PP+Parent2PP| JournalPap + Categorie_Parent1 + Parent2_Categorie, data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~AxePP+Parent1PP+Parent2PP|  Categorie_Parent1 + Parent2_Categorie, data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~AxePP+Parent1PP+Parent2PP| Revenu + Age + Proprietaire + Categorie_Parent1 + Parent2_Categorie, data=BaseModele)
summary(ml.PP)
ml.PP <- mlogit(PP~AxePP+Parent1PP+Parent2PP| Type_Habitation + Revenu + Age + Proprietaire + Categorie_Parent1 + Parent2_Categorie, data=BaseModele)
summary(ml.PP)
Fit1<-vglm(PP~Categorie_Parent1,multinomial(refLevel=1),data=baseEco2)
summary(Fit1)
ml1.PP <- mlogit(PP~0|Categorie_Parent1, data=BaseModele)
summary(ml1.PP)
ml2.PP <- mlogit(PP~AxePP| Categorie_Parent1 , data=BaseModele)
ml1.PP <- mlogit(PP~0|Categorie_Parent1, data=BaseModele)
summary(ml1.PP)
ml2.PP <- mlogit(PP~AxePP| Categorie_Parent1 , data=BaseModele)
summary(ml2.PP)
ml3.PP <- mlogit(PP~AxePP+Parent1PP| Categorie_Parent1 , data=BaseModele)
summary(ml3.PP)
ml4.PP <- mlogit(PP~AxePP+Parent1PP+Parent2PP| Categorie_Parent1, data=BaseModele)
summary(ml4.PP)
#Test des LikeHood
library(lmtest)
lrtest(ml1.PP,ml2.PP,ml3.PP,ml4.PP)
lrtest(ml2.PP,ml1.PP,ml3.PP,ml4.PP)
lrtest(ml2.PP,ml1.PP)
lrtest(ml1.PP,ml2.PP)
lrtest(ml2.PP,ml1.PP)
lrtest(ml4.PP,ml1.PP)
lrtest(ml1.PP,ml2.PP,ml3.PP,ml4.PP)
lrtest(ml2.PP,ml4.PP)
library(stargazer)
stargazer(lrtest(ml1.PP,ml2.PP,ml3.PP,ml4.PP),type="txt",out="lrtest.txt")
stargazer(lrtest(ml1.PP,ml2.PP,ml3.PP,ml4.PP),type="text",out="lrtest.txt")
lrtest(ml1.PP,ml2.PP,ml3.PP,ml4.PP)
lrtest(ml2.PP, ml1.PP)
lrtest(ml2.PP,ml4.PP)
lrtest(ml2.PP,ml3.PP)
ml2.PP2 <- mlogit(PP~AxePP| Categorie_Parent1 , heterosc = TRUE, data=BaseModele)
summary(ml2.PP2)
ml2.PP2 <- mlogit(PP~AxePP| Categorie_Parent1 , heterosc = TRUE, data=BaseModele)
ml1.PP2 <- mlogit(PP~0|Categorie_Parent1, heterosc = TRUE,data=BaseModele)
ml2.PP <- mlogit(PP~AxePP| Categorie_Parent1 , reflevel="9",data=BaseModele)
summary(ml2.PP)
ml1.PP2 <- mlogit(PP~0|Categorie_Parent1, heterosc = TRUE,data=BaseModele)
summary(ml1.PP2)#Ne fonctionne pas car matrice non inversible
ml2.PP <- mlogit(PP~AxePP| Categorie_Parent1 , data=BaseModele)
summary(ml2.PP)#Modele avec hypothese des erreurs homoscedastiques
ml2.PP <- mlogit(PP~AxePP| Categorie_Parent1 , reflevel="15",data=BaseModele)
summary(ml2.PP)
ml2.PP <- mlogit(PP~AxePP| Categorie_Parent1 , reflevel="1",data=BaseModele)
summary(ml2.PP)
ml2.PP <- mlogit(PP~AxePP| Categorie_Parent1 , reflevel="8",data=BaseModele)
summary(ml2.PP)
ml2.PP <- mlogit(PP~AxePP| Categorie_Parent1 , reflevel="7",data=BaseModele)
summary(ml2.PP)
ml2.PP <- mlogit(PP~AxePP| Categorie_Parent1 , data=BaseModele)
summary(ml2.PP)#Modele avec hypothese des erreurs homoscedastiques
ml2.PP <- mlogit(PP~AxePP| Categorie_Parent1 , reflevel="7",data=BaseModele)
summary(ml2.PP)
ml2.PP <- mlogit(PP~AxePP| Categorie_Parent1 , reflevel="8",data=BaseModele)
summary(ml2.PP)
ml2.PP <- mlogit(PP~AxePP| Categorie_Parent1 , reflevel="9",data=BaseModele)
summary(ml2.PP)
ml2.PP <- mlogit(PP~AxePP| Categorie_Parent1 , reflevel="10",data=BaseModele)
summary(ml2.PP)
ml2.PP <- mlogit(PP~AxePP| Categorie_Parent1 , reflevel="11",data=BaseModele)
summary(ml2.PP)
ml2.PP <- mlogit(PP~AxePP| Categorie_Parent1 , reflevel="12",data=BaseModele)
summary(ml2.PP)
ml2.PP <- mlogit(PP~AxePP| Categorie_Parent1 , reflevel="13",data=BaseModele)
summary(ml2.PP)
ml2.PP <- mlogit(PP~AxePP| Categorie_Parent1 , reflevel="14",data=BaseModele)
summary(ml2.PP)
ml2.PP <- mlogit(PP~AxePP| Categorie_Parent1 , reflevel="15",data=BaseModele)
summary(ml2.PP)
ml2.PP <- mlogit(PP~AxePP| Categorie_Parent1 , reflevel="16",data=BaseModele)
summary(ml2.PP)
ml2.PP <- mlogit(PP~AxePP| Categorie_Parent1 , reflevel="1",data=BaseModele)
summary(ml2.PP)
ml2.PP <- mlogit(PP~AxePP| Categorie_Parent1 , reflevel="2",data=BaseModele)
summary(ml2.PP)
ml2.PP <- mlogit(PP~AxePP| Categorie_Parent1 , reflevel="3",data=BaseModele)
summary(ml2.PP)
ml2.PP <- mlogit(PP~AxePP| Categorie_Parent1 , reflevel="4",data=BaseModele)
summary(ml2.PP)
ml2.PP <- mlogit(PP~AxePP| Categorie_Parent1 , reflevel="5",data=BaseModele)
summary(ml2.PP)
ml2.PP <- mlogit(PP~AxePP| Categorie_Parent1 , reflevel="6",data=BaseModele)
summary(ml2.PP)
ml2.PP <- mlogit(PP~AxePP| Categorie_Parent1 , reflevel="7",data=BaseModele)
summary(ml2.PP)
ml2.PP <- mlogit(PP~AxePP| Categorie_Parent1 , reflevel="14",data=BaseModele)
summary(ml2.PP)
ml2.PP <- mlogit(PP~AxePP| Categorie_Parent1 , data=BaseModele)
summary(ml2.PP)#Modele avec hypothese des erreurs homoscedastiques
ooo <- with(baseEco2, order(Categorie_Parent1))
with(baseEco2, matplot(Categorie_Parent1[ooo], fitted(ml2.PP)[ooo,], ylim = c(0,1),
xlab = "Categorie Parent1", ylab = "Probabilité estimée",
main = " Effet de la variable Age ", type = "l", lwd = 2, col = Categorie_Parent1))
#VGLM
library(VGAM)
Fit <- vglm(PP~Categorie_Parent1,data=baseEco2)
Fit <- vglm(PP~Categorie_Parent1,multinomial(refLevel=7),data=baseEco2)
summary(Fit)
Fit <- vglm(PP~Categorie_Parent1,multinomial(refLevel=1),data=baseEco2)
summary(Fit)
Fit <- vglm(PP~Categorie_Parent1,multinomial(refLevel=15),data=baseEco2)
summary(Fit)
Fit <- vglm(PP~Categorie_Parent1,multinomial(refLevel=3),data=baseEco2)
summary(Fit)
Fit <- vglm(PP~Categorie_Parent1,multinomial(refLevel=4),data=baseEco2)
summary(Fit)
Fit <- vglm(PP~Categorie_Parent1,multinomial(refLevel=7),data=baseEco2)
summary(Fit)
Fit <- vglm(PP~Categorie_Parent1,multinomial(refLevel=14),data=baseEco2)
summary(Fit)
Fit <- vglm(PP~Categorie_Parent1,multinomial(refLevel=7),data=baseEco2)
summary(Fit)
ooo <- with(baseEco2, order(Categorie_Parent1))
with(baseEco2, matplot(Categorie_Parent1[ooo], fitted(Fit)[ooo,], ylim = c(0,1),
xlab = "Categorie Parent1", ylab = "Probabilité estimée",
main = " Effet de la variable Age ", type = "l", lwd = 2, col = Categorie_Parent1))
with(baseEco2, rug(Categorie_Parent1))
legend("topright", col = Categorie_Parent1, lty=1:3
,legend=colnames(Fit@y))
legend("topright", col = baseEco2$Categorie_Parent1, lty=1:3
,legend=colnames(Fit@y))
ooo <- with(baseEco2, order(Categorie_Parent1))
with(baseEco2, matplot(Categorie_Parent1[ooo], fitted(Fit)[ooo,], ylim = c(0,1),
xlab = "Categorie Parent1", ylab = "Probabilité estimée",
main = " Effet de la variable Categorie Parent1 ", type = "l", lwd = 2, col = Categorie_Parent1))
with(baseEco2, rug(Categorie_Parent1))
legend("topright", col = baseEco2$Categorie_Parent1, lty=1:3
,legend=colnames(Fit@y))
ooo <- with(BaseModele, order(Categorie_Parent1))
with(BaseModele, matplot(Categorie_Parent1[ooo], fitted(ml2.PP)[ooo,], ylim = c(0,1),
xlab = "Categorie Parent1", ylab = "Probabilité estimée",
main = " Effet de la variable Categorie Parent1 ", type = "l", lwd = 2, col = Categorie_Parent1))
Fit <- vglm(PP~Categorie_Parent1,multinomial(refLevel=7),data=baseEco2)
summary(Fit)
stargazer(Fit, type="text", out="vglm.txt")
Fit <- vglm(PP~Categorie_Parent1,multinomial(refLevel=5),data=baseEco2)
summary(Fit)
Fit <- vglm(PP~Categorie_Parent1,multinomial(refLevel=4),data=baseEco2)
summary(Fit)
Fit <- vglm(PP~Categorie_Parent1,multinomial(refLevel=1),data=baseEco2)
summary(Fit)
Fit <- vglm(PP~Categorie_Parent1,multinomial(refLevel=6),data=baseEco2)
summary(Fit)
Fit <- vglm(PP~Categorie_Parent1,multinomial(refLevel=115),data=baseEco2)
Fit <- vglm(PP~Categorie_Parent1,multinomial(refLevel=15),data=baseEco2)
summary(Fit)
Fit <- vglm(PP~Categorie_Parent1,multinomial(refLevel=14),data=baseEco2)
summary(Fit)
Fit <- vglm(PP~Categorie_Parent1,multinomial(refLevel=13),data=baseEco2)
summary(Fit)
Fit <- vglm(PP~Categorie_Parent1,multinomial(refLevel=18),data=baseEco2)
Fit <- vglm(PP~Categorie_Parent1,multinomial(refLevel=1),data=baseEco2)
summary(Fit)
m
summary(ml1.PP)
#Revenu
Fit <- vglm(PP~Revenu,multinomial(refLevel=1),data=baseEco2)
summary(Fit)
#Mlogit avec en reference le parti politique 15 afin de verifier l'absence de corrélation
nl.PP2 <- mlogit(PP~AxePP|Categorie_Parent1,data=BaseModele,reflevel="15",nests=list(Type1="15",Type2=c("1","2","3","4","5","6","7","8","9","10","11","12","13","14")),unscaled=TRUE)
#Mlogit avec en reference le parti politique 15 afin de verifier l'absence de corrélation
nl.PP2 <- mlogit(PP~AxePP|Categorie_Parent1,data=BaseModele,reflevel="15",nests=list(Type1="15",Type2=c("2","3","4","5","6","7","8","9","10","11","12","13","14")),unscaled=TRUE)
#Mlogit avec en reference le parti politique 15 afin de verifier l'absence de corrélation
nl.PP2 <- mlogit(PP~AxePP|Categorie_Parent1,data=BaseModele,reflevel="15",nests=list(Type1="15",Type2=c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","16","17","18","19")),unscaled=TRUE)
#Mlogit avec en reference le parti politique 15 afin de verifier l'absence de corrélation
ml.PP2<-mlogit(PP~AxePP|Categorie_Parent1,data=BaseModele,reflevel="15")
scoretest(ml.PP2,nests=list(type1="15",type2=c("1","2","3","4","5","6","7","8","9","10","11","12","13","14")),unscaled=TRUE)
scoretest(ml.PP2,nests=list(type1="15",type2=c("1","2","3","4","5","6","7","8","9","10","11","12","13","14","16","17","18","19")),unscaled=TRUE)
#Mlogit avec en reference le parti politique 15 afin de verifier l'absence de corrélation
#changement de base en enlevant les aprtis n'ayant recu aucun vote
BaseModele<-mlogit.data(baseEco2[, c(44,50,50,63,69,70,82,88,89)],shape="wide",varying=c(34:51,53:70,72:89),choice="PP")
#Mlogit avec en reference le parti politique 15 afin de verifier l'absence de corrélation
#changement de base en enlevant les aprtis n'ayant recu aucun vote
baseEco3 <- baseEco2[, c(44,50,50,63,69,70,82,88,89)]
View(baseEco3)
#Mlogit avec en reference le parti politique 15 afin de verifier l'absence de corrélation
#changement de base en enlevant les aprtis n'ayant recu aucun vote
baseEco3 <- baseEco2[, -c(44,50,50,63,69,70,82,88,89)]
#Mlogit avec en reference le parti politique 15 afin de verifier l'absence de corrélation
#changement de base en enlevant les aprtis n'ayant recu aucun vote
baseEco3 <- baseEco2[, -c(44,50,51,63,69,70,82,88,89)]
BaseModele<-mlogit.data(baseEco3,shape="wide",varying=c(34:48,51:65,67:81),choice="PP")
BaseModele<-mlogit.data(baseEco3,shape="wide",varying=c(34:48,50:64,66:80),choice="PP")
scoretest(ml.PP2,nests=list(type1="15",type2=c("1","2","3","4","5","6","7","8","9","10","12","13","14","16")),unscaled=TRUE)
scoretest(ml.PP2,nests=list(type1="15",type2=c("1","2","3","4","5","6","7","8","9","10","12","13","14","16","19")),unscaled=TRUE)
scoretest(ml.PP2,nests=list(type1="15",type2=c("1","2","3","4","5","6","7","8","9","10","12","13","14","16")),unscaled=TRUE)
ml.PP2<-mlogit(PP~AxePP|Categorie_Parent1,data=BaseModele,reflevel="15")
scoretest(ml.PP2,nests=list(type1="15",type2=c("1","2","3","4","5","6","7","8","9","10","12","13","14","16")),unscaled=TRUE)
nl.PP2 <- mlogit(PP~AxePP|Categorie_Parent1,data=BaseModele,reflevel="15",nests=list(Type1="15",Type2=c("1","2","3","4","5","6","7","8","9","10","12","13","14","16")),unscaled=TRUE)
summary(ml.PP2)
ml.PP2<-mlogit(PP~AxePP+Parent1PP+Parent2PP|Categorie_Parent1,data=BaseModele,reflevel="15")
summary(ml.PP2)
ml.PP2<-mlogit(PP~AxePP+Parent1PP+Parent2PP|0,data=BaseModele,reflevel="15")
summary(ml.PP2)
ml.PP2<-mlogit(PP~AxePP+Parent1PP+Parent2PP|Revenu,data=BaseModele,reflevel="15")
summary(ml.PP2)
ml.PP2<-mlogit(PP~AxePP+Parent1PP+Parent2PP|Revenu + Categorie_Parent1,data=BaseModele,reflevel="15")
summary(ml.PP2)
ml.PP2<-mlogit(PP~AxePP+Parent1PP+Parent2PP|Categorie_Parent1,data=BaseModele,reflevel="15")
summary(ml.PP2)
ml.PP2<-mlogit(PP~AxePP+Parent1PP+Parent2PP|Categorie_Parent1,data=BaseModele)
summary(ml.PP2)
ml.PP21<-mlogit(PP~AxePP+Parent1PP+Parent2PP|Categorie_Parent1,data=BaseModele)
ml.PP2<-mlogit(PP~AxePP+Parent1PP+Parent2PP|Categorie_Parent1,data=BaseModele,reflevel="15")
lrtest(ml.PP21,ml.PP2)
ml.PP22<-mlogit(PP~AxePP+Parent1PP+Parent2PP|Categorie_Parent1,heterosc = TRUE,data=BaseModele,reflevel="15")
ml.PP22<-mlogit(PP~AxePP+Parent1PP+Parent2PP|Categorie_Parent1,heterosc = FALSE,data=BaseModele,reflevel="15")#Ne foncito
lrtest(ml.PP21,ml.PP2)
nl.PP2 <- mlogit(PP~AxePP|Categorie_Parent1,data=BaseModele,reflevel="15",nests=list(Type1="15",Type2=c("1","2","3","4","5","6","7","8","9","10","12","13","14","16")),unscaled=TRUE)
lrtest(nl.Marque)
lrtest(nl.PP2)
nl.PP2 <- mlogit(PP~AxePP+Parent1PP+Parent2PP|Categorie_Parent1,data=BaseModele,reflevel="15",nests=list(Type1="15",Type2=c("1","2","3","4","5","6","7","8","9","10","12","13","14","16")),unscaled=TRUE)
lrtest(nl.PP2)
summary(nl.PP2)
lrtest(ml.PP21,ml.PP2)
ml.PP2<-mlogit(PP~AxePP+Parent1PP+Parent2PP|Categorie_Parent1 + Age,data=BaseModele,reflevel="15")
summary(ml.PP2)
ml.PP2<-mlogit(PP~AxePP+Parent1PP+Parent2PP| Age,data=BaseModele,reflevel="15")
summary(ml.PP2)
ml.PP2<-mlogit(PP~AxePP+Parent1PP+Parent2PP| Categorie_Parent1 + Age,data=BaseModele,reflevel="15")
summary(ml.PP2)
ml.PP2<-mlogit(PP~AxePP+Parent1PP+Parent2PP| Revenu + Age,data=BaseModele,reflevel="15")
summary(ml.PP2)
ml.PP2<-mlogit(PP~AxePP+Parent1PP+Parent2PP| Categorie + Age,data=BaseModele,reflevel="15")
summary(ml.PP2)
ml.PP2<-mlogit(PP~AxePP+Parent1PP+Parent2PP| Categorie,data=BaseModele,reflevel="15")
summary(ml.PP2)
ml.PP2<-mlogit(PP~AxePP+Parent1PP+Parent2PP| Age + MediaPrinc,data=BaseModele,reflevel="15")
ml.PP2<-mlogit(PP~AxePP+Parent1PP+Parent2PP| Age + Media_Princ,data=BaseModele,reflevel="15")
summary(ml.PP2)
ml.PP2<-mlogit(PP~AxePP+Parent1PP+Parent2PP| Age + Type_Hab,data=BaseModele,reflevel="15")
ml.PP2<-mlogit(PP~AxePP+Parent1PP+Parent2PP| Age + Type_Habitation,data=BaseModele,reflevel="15")
summary(ml.PP2)
ml.PP21<-mlogit(PP~AxePP+Parent1PP+Parent2PP|Age + Type_Habitation,data=BaseModele)
lrtest(ml.PP21,ml.PP2)
ml.PP2<-mlogit(PP~AxePP+Parent1PP+Parent2PP| Age + Type_Habitation + Proprietaire,data=BaseModele,reflevel="15")
summary(ml.PP2)
ml.PP2<-mlogit(PP~AxePP+Parent1PP+Parent2PP| Age + Type_Habitation,data=BaseModele,reflevel="15")
summary(ml.PP2)
stargazer(ml.PP21, type="text")
stargazer(ml.PP21, type="text", out="ml_PP21.txt")
stargazer(ml.PP2, type="text", out="ml_PP21.txt")
summary(ml.PP2)
scoretest(ml.PP2,nests=list(type1="15",type2=c("1","2","3","4","5","6","7","8","9","10","12","13","14","16")),unscaled=TRUE)
nl.PP2 <- mlogit(PP~AxePP+Parent1PP+Parent2PP|Age + Type_Habitation,data=BaseModele,reflevel="15",nests=list(Type1="15",Type2=c("1","2","3","4","5","6","7","8","9","10","12","13","14","16")),unscaled=TRUE)
nl.PP2 <- mlogit(PP~AxePP+Parent1PP+Parent2PP|Type_Habitation,data=BaseModele,reflevel="15",nests=list(Type1="15",Type2=c("1","2","3","4","5","6","7","8","9","10","12","13","14","16")),unscaled=TRUE)
nl.PP2 <- mlogit(PP~AxePP+Parent1PP+Parent2PP|Age,data=BaseModele,reflevel="15",nests=list(Type1="15",Type2=c("1","2","3","4","5","6","7","8","9","10","12","13","14","16")),unscaled=TRUE)
nl.PP2 <- mlogit(PP~AxePP+Parent1PP+Parent2PP|Categorie_Parent1,data=BaseModele,reflevel="15",nests=list(Type1="15",Type2=c("1","2","3","4","5","6","7","8","9","10","12","13","14","16")),unscaled=TRUE)
#ScoreTest ne fonctionne pas pour age et type habitation
nl.PP2 <- mlogit(PP~AxePP+Parent1PP+Parent2PP|Age+Type_Habitation,data=BaseModele,reflevel="15",nests=list(Type1="15",Type2=c("1","2","3","4","5","6","7","8","9","10","12","13","14","16")),unscaled=TRUE)
nl.PP2 <- mlogit(PP~AxePP+Parent1PP+Parent2PP|Categorie_Parent1,data=BaseModele,reflevel="15",nests=list(Type1="15",Type2=c("1","2","3","4","5","6","7","8","9","10","12","13","14","16")),unscaled=TRUE)
lrtest(nl.PP2)
summary(nl.PP2)
stargazer(nl.PP2,type="text",out="scoretest")
stargazer(nl.PP2,type="text",out="scoretest.txt")
#ScoreTest ne fonctionne pas pour age et type habitation
nl.PP2 <- mlogit(PP~AxePP+Parent1PP+Parent2PP|Age+Type_Habitation,data=BaseModele,reflevel="15",nests=list(Type1="15",Type2=c("1","2","3","4","5","6","7","8","9","10","12","13","14","16")),unscaled=TRUE)
#Plot par rapport à la categorie des parents
Fit <- vglm(PP~Age + Type_Habitation,multinomial(refLevel=15),data=baseEco3)
summary(Fit)
ooo <- with(baseEco3, order(Type_Habitation))
with(baseEco3, matplot(Type_Habitation[ooo], fitted(Fit)[ooo,], ylim = c(0,1),
xlab = "Type Habitation", ylab = "Probabilité estimée",
main = " Effet de la variable Type Habitation ", type = "l", lwd = 2, col = Type_Habitation))
with(baseEco3, rug(Type_Habitation))
legend("topright", col = baseEco3$Type_Habitation, lty=1:3
,legend=colnames(Fit@y))
with(baseEco3, matplot(Type_Habitation[ooo], fitted(Fit)[ooo,], ylim = c(0,1),
xlab = "Type Habitation", ylab = "Probabilité estimée",
main = " Effet de la variable Type Habitation ", type = "l", lwd = 2, col = Type_Habitation))
with(baseEco3, rug(Type_Habitation))
legend("topright", col = baseEco3$Type_Habitation, lty=1:3
,legend=colnames(Fit@y))
#Plot par rapport à la Age
Fit <- vglm(PP~Age + type_Habitation,multinomial(refLevel=15),data=baseEco3)
#Plot par rapport à la Age
ooo <- with(baseEco3, order(Age))
with(baseEco3, matplot(Age[ooo], fitted(Fit)[ooo,], ylim = c(0,1),
xlab = "Age", ylab = "Probabilité estimée",
main = " Effet de la variable Age ", type = "l", lwd = 2, col = Age))
with(baseEco3, rug(Age))
legend("topright", col = baseEco3$Age, lty=1:3
,legend=colnames(Fit@y))
margeff(ml.PP2)
exp(coeff(ml.PP2))
exp(coef(ml.PP2))
margeff(ml.PP2)
effect(ml.PP2, covariate="Age",data=BaseModele)
effects(ml.PP2, covariate="Age",data=BaseModele)
exp(coef(ml.PP2))
exp(coef(ml.PP2))
exp(coef(ml.PP2))
stargazer(exp(coef(ml.PP2)), type="text")
stargazer(exp(coef(ml.PP2)), type="text", out="odds_ratio.txt")
moy <- with(BaseModele, data.frame(AxePP = tapply(AxePP, index(BaseModele)$alt, mean),Parent1PP = tapply(Parent1PP, index(BaseModele)$alt, mean),Parent2PP = tapply(Parent2PP, index(BaseModele)$alt, mean), Age = mean(Age), Type_Habitation = mean(Type_Habitation)))
effects(ml.PP2, covariate = "Age", data = moy)
effects(ml.PP2, covariate = "Age", data = moy) #Effet Marginaux moyen pour l'age
stargazer(effects(ml.PP2, covariate = "Age", data = moy), type="text", out="effet_marg.txt") #Effet Marginaux moyen pour l'age
)
ml.PP4 <- mlogit(PP~AxePP+Parent1PP+Parent2PP| Age + Type_Habitation + Sexe ,data=BaseModele,reflevel="15")
summary(ml.PP4)
ml.PP4 <- mlogit(PP~AxePP+Parent1PP+Parent2PP| Categorie_Parent1 + Parent2_Categorie ,data=BaseModele,reflevel="15")
summary(ml.PP4)
ml.PP4 <- mlogit(PP~AxePP+Parent1PP+Parent2PP|  Parent2_Categorie ,data=BaseModele,reflevel="15")
summary(ml.PP4)
ml.PP4 <- mlogit(PP~AxePP+Parent1PP+Parent2PP| Age + Type_Habitattion Parent2_Categorie ,data=BaseModele,reflevel="15")
ml.PP4 <- mlogit(PP~AxePP+Parent1PP+Parent2PP| Age + Type_Habitation + Parent2_Categorie ,data=BaseModele,reflevel="15")
summary(ml.PP4)
ml.PP5 <- mlogit(PP~AxePP+Parent1PP+Parent2PP| Age + Type_Habitation + Parent2_Categorie ,data=BaseModele,reflevel="15")
summary(ml.PP5) #Better
ml.PP6 <- mlogit(PP~AxePP+Parent1PP+Parent2PP| Age + Type_Habitation + Parent2_Categorie + JournalTv,data=BaseModele,reflevel="15")
summary(ml.PP6)
ml.PP7 <- mlogit(PP~AxePP+Parent1PP+Parent2PP| Maire.PP + Type_Habitation + Parent2_Categorie + JournalTv,data=BaseModele,reflevel="15")
summary(ml.PP7)
#ml.PP6
ml.PP6 <- mlogit(PP~AxePP+Parent1PP+Parent2PP| Age + Type_Habitation + Parent2_Categorie + JournalTv,heterosc=TRUE,data=BaseModele,reflevel="15")
#lrtest entre PP6 et PP7
lrtest(ml.PP6,ml.PP7)
lrtest(ml.PP7,ml.PP6)
#Plot pour Maire.PP et Journal TV
Fit <- vglm(PP~Maire.PP + Type_Habitation + Parent2_Categorie + JournalTv,multinomial(refLevel=14),data=baseEco3)
summary(Fit)
ooo <- with(baseEco3, order(Maire.PP))
with(baseEco3, matplot(Maire.PP[ooo], fitted(Fit)[ooo,], ylim = c(0,1),
xlab = "Maire PP", ylab = "Probabilité estimée",
main = " Effet de la variable Maire PP ", type = "l", lwd = 2, col = Maire.PP))
with(baseEco3, rug(Maire.PP))
legend("topright", col = baseEco3$Maire.PP, lty=1:3
,legend=colnames(Fit@y))
stargazer(ml.PP6, type="text",out="m1.txt")#More Better
stargazer(ml.PP6, type="text",out="modeleannexe.txt")#More Better
#Maire.PP est considéré comme variable lié à l'individu et non au type de vote
stargazer(ml.PP6, type="text",out="modeleannexe2.txt")
#plot 2
ooo <- with(baseEco3, order(JournalTV))
#plot 2
ooo <- with(baseEco3, order(JournalTv))
ooo <- with(baseEco3, order(Maire.PP))
with(baseEco3, matplot(Maire.PP[ooo], fitted(Fit)[ooo,], ylim = c(0,1),
xlab = "Maire PP", ylab = "Probabilité estimée",
main = " Effet de la variable Maire PP ", type = "l", lwd = 2, col = Maire.PP))
with(baseEco3, rug(Maire.PP))
legend("topright", col = baseEco3$Maire.PP, lty=1:4
,legend=colnames(Fit@y))
l
legend("topright", col = baseEco3$Maire.PP, lty=1:5
,legend=colnames(Fit@y))
#plot 2
ooo <- with(baseEco3, order(JournalTv))
with(baseEco3, matplot(JournalTv[ooo], fitted(Fit)[ooo,], ylim = c(0,1),
xlab = "JournalTV", ylab = "Probabilité estimée",
main = " Effet de la variable JournalTV ", type = "l", lwd = 2, col = JournalTV))
with(baseEco3, matplot(JournalTv[ooo], fitted(Fit)[ooo,], ylim = c(0,1),
xlab = "JournalTV", ylab = "Probabilité estimée",
main = " Effet de la variable JournalTV ", type = "l", lwd = 2, col = JournalTv))
with(baseEco3, rug(JournalTv))
legend("topright", col = baseEco3$JournalTv, lty=1:3
,legend=colnames(Fit@y))
with(baseEco3, matplot(JournalTv[ooo], fitted(Fit)[ooo,], ylim = c(0,1),
xlab = "JournalTV", ylab = "Probabilité estimée",
main = " Effet de la variable JournalTV ", type = "l", lwd = 2, col = JournalTv))
#plot 2
ooo <- with(baseEco3, order(JournalTv))
with(baseEco3, matplot(JournalTv[ooo], fitted(Fit)[ooo,], ylim = c(0,1),
xlab = "JournalTV", ylab = "Probabilité estimée",
main = " Effet de la variable JournalTV ", type = "l", lwd = 2, col = PP))
with(baseEco3, rug(JournalTv))
legend("topright", col = baseEco3$PP, lty=1:3
,legend=colnames(Fit@y))
ooo <- with(baseEco3, order(Maire.PP))
with(baseEco3, matplot(Maire.PP[ooo], fitted(Fit)[ooo,], ylim = c(0,1),
xlab = "Maire PP", ylab = "Probabilité estimée",
main = " Effet de la variable Maire PP ", type = "l", lwd = 2, col = PP))
with(baseEco3, rug(Maire.PP))
legend("topright", col = baseEco3$PP, lty=1:5
,legend=colnames(Fit@y))
with(baseEco3, rug(Maire.PP))
legend("topright", col = baseEco3$PP, lty=1:2
,legend=colnames(Fit@y))
with(baseEco3, rug(Maire.PP))
legend("topright", col = baseEco3$PP, lty=1:1
,legend=colnames(Fit@y))
with(baseEco3, rug(Maire.PP))
legend("topright", col = baseEco3$PP, lty=1:8
,legend=colnames(Fit@y))
#plot 2
ooo <- with(baseEco3, order(JournalTv))
with(baseEco3, matplot(JournalTv[ooo], fitted(Fit)[ooo,], ylim = c(0,1),
xlab = "JournalTV", ylab = "Probabilité estimée",
main = " Effet de la variable JournalTV ", type = "l", lwd = 2, col = PP))
with(baseEco3, rug(JournalTv))
legend("topright", col = baseEco3$PP, lty=1:3
,legend=colnames(Fit@y))
#Maire.PP est considéré comme variable lié à l'individu et non au type de vote
stargazer(ml.PP7, type="text",out="modeleannexe2.txt")
